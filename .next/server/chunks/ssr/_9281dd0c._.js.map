{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///D:/Web%20development/projects/doctors-appointment-platform/actions/onboarding.js"],"sourcesContent":["\"use server\";\r\n\r\nimport { db } from \"@/lib/prisma\";\r\nimport { auth } from \"@clerk/nextjs/server\";\r\nimport { revalidatePath } from \"next/cache\";\r\n\r\n/**\r\n * Sets the user's role and related information\r\n */\r\nexport async function setUserRole(formData) {\r\n  const { userId } = await auth();\r\n\r\n  if (!userId) {\r\n    throw new Error(\"Unauthorized\");\r\n  }\r\n\r\n  // Find user in our database\r\n  const user = await db.user.findUnique({\r\n    where: { clerkUserId: userId },\r\n  });\r\n\r\n  if (!user) throw new Error(\"User not found in database\");\r\n\r\n  const role = formData.get(\"role\");\r\n\r\n  if (!role || ![\"PATIENT\", \"DOCTOR\"].includes(role)) {\r\n    throw new Error(\"Invalid role selection\");\r\n  }\r\n\r\n  try {\r\n    // For patient role - simple update\r\n    if (role === \"PATIENT\") {\r\n      await db.user.update({\r\n        where: {\r\n          clerkUserId: userId,\r\n        },\r\n        data: {\r\n          role: \"PATIENT\",\r\n        },\r\n      });\r\n\r\n      revalidatePath(\"/\");\r\n      return { success: true, redirect: \"/doctors\" };\r\n    }\r\n\r\n    // For doctor role - need additional information\r\n    if (role === \"DOCTOR\") {\r\n      const specialty = formData.get(\"specialty\");\r\n      const experience = parseInt(formData.get(\"experience\"), 10);\r\n      const credentialUrl = formData.get(\"credentialUrl\");\r\n      const description = formData.get(\"description\");\r\n\r\n      // Validate inputs\r\n      if (!specialty || !experience || !credentialUrl || !description) {\r\n        throw new Error(\"All fields are required\");\r\n      }\r\n\r\n      await db.user.update({\r\n        where: {\r\n          clerkUserId: userId,\r\n        },\r\n        data: {\r\n          role: \"DOCTOR\",\r\n          specialty,\r\n          experience,\r\n          credentialUrl,\r\n          description,\r\n          verificationStatus: \"PENDING\",\r\n        },\r\n      });\r\n\r\n      revalidatePath(\"/\");\r\n      return { success: true, redirect: \"/doctor/verification\" };\r\n    }\r\n  } catch (error) {\r\n    console.error(\"Failed to set user role:\", error);\r\n    throw new Error(`Failed to update user profile: ${error.message}`);\r\n  }\r\n}\r\n\r\n/**\r\n * Gets the current user's complete profile information\r\n */\r\nexport async function getCurrentUser() {\r\n  const { userId } = await auth();\r\n\r\n  if (!userId) {\r\n    return null;\r\n  }\r\n\r\n  try {\r\n    const user = await db.user.findUnique({\r\n      where: {\r\n        clerkUserId: userId,\r\n      },\r\n    });\r\n\r\n    return user;\r\n  } catch (error) {\r\n    console.error(\"Failed to get user information:\", error);\r\n    return null;\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAEA;AACA;AACA;;;;;;;AAKO,eAAe,YAAY,QAAQ;IACxC,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,CAAA,GAAA,mLAAA,CAAA,OAAI,AAAD;IAE5B,IAAI,CAAC,QAAQ;QACX,MAAM,IAAI,MAAM;IAClB;IAEA,4BAA4B;IAC5B,MAAM,OAAO,MAAM,6GAAA,CAAA,KAAE,CAAC,IAAI,CAAC,UAAU,CAAC;QACpC,OAAO;YAAE,aAAa;QAAO;IAC/B;IAEA,IAAI,CAAC,MAAM,MAAM,IAAI,MAAM;IAE3B,MAAM,OAAO,SAAS,GAAG,CAAC;IAE1B,IAAI,CAAC,QAAQ,CAAC;QAAC;QAAW;KAAS,CAAC,QAAQ,CAAC,OAAO;QAClD,MAAM,IAAI,MAAM;IAClB;IAEA,IAAI;QACF,mCAAmC;QACnC,IAAI,SAAS,WAAW;YACtB,MAAM,6GAAA,CAAA,KAAE,CAAC,IAAI,CAAC,MAAM,CAAC;gBACnB,OAAO;oBACL,aAAa;gBACf;gBACA,MAAM;oBACJ,MAAM;gBACR;YACF;YAEA,CAAA,GAAA,6HAAA,CAAA,iBAAc,AAAD,EAAE;YACf,OAAO;gBAAE,SAAS;gBAAM,UAAU;YAAW;QAC/C;QAEA,gDAAgD;QAChD,IAAI,SAAS,UAAU;YACrB,MAAM,YAAY,SAAS,GAAG,CAAC;YAC/B,MAAM,aAAa,SAAS,SAAS,GAAG,CAAC,eAAe;YACxD,MAAM,gBAAgB,SAAS,GAAG,CAAC;YACnC,MAAM,cAAc,SAAS,GAAG,CAAC;YAEjC,kBAAkB;YAClB,IAAI,CAAC,aAAa,CAAC,cAAc,CAAC,iBAAiB,CAAC,aAAa;gBAC/D,MAAM,IAAI,MAAM;YAClB;YAEA,MAAM,6GAAA,CAAA,KAAE,CAAC,IAAI,CAAC,MAAM,CAAC;gBACnB,OAAO;oBACL,aAAa;gBACf;gBACA,MAAM;oBACJ,MAAM;oBACN;oBACA;oBACA;oBACA;oBACA,oBAAoB;gBACtB;YACF;YAEA,CAAA,GAAA,6HAAA,CAAA,iBAAc,AAAD,EAAE;YACf,OAAO;gBAAE,SAAS;gBAAM,UAAU;YAAuB;QAC3D;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,MAAM,IAAI,MAAM,CAAC,+BAA+B,EAAE,MAAM,OAAO,EAAE;IACnE;AACF;AAKO,eAAe;IACpB,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,CAAA,GAAA,mLAAA,CAAA,OAAI,AAAD;IAE5B,IAAI,CAAC,QAAQ;QACX,OAAO;IACT;IAEA,IAAI;QACF,MAAM,OAAO,MAAM,6GAAA,CAAA,KAAE,CAAC,IAAI,CAAC,UAAU,CAAC;YACpC,OAAO;gBACL,aAAa;YACf;QACF;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mCAAmC;QACjD,OAAO;IACT;AACF;;;IA7FsB;IA0EA;;AA1EA,+OAAA;AA0EA,+OAAA","debugId":null}},
    {"offset": {"line": 122, "column": 0}, "map": {"version":3,"sources":["file:///D:/Web%20development/projects/doctors-appointment-platform/app/%28main%29/onboarding/layout.js"],"sourcesContent":["import { getCurrentUser } from \"@/actions/onboarding\";\r\nimport { redirect } from \"next/navigation\";\r\n\r\nexport const metadata = {\r\n  title: \"Onboarding - MediMeet\",\r\n  description: \"Complete your profile to get started with MediMeet\",\r\n};\r\n\r\nexport default async function OnboardingLayout({ children }) {\r\n  // Get complete user profile\r\n  const user = await getCurrentUser();\r\n\r\n  // Redirect users who have already completed onboarding\r\n  if (user) {\r\n    if (user.role === \"PATIENT\") {\r\n      redirect(\"/doctors\");\r\n    } else if (user.role === \"DOCTOR\") {\r\n      // Check verification status for doctors\r\n      if (user.verificationStatus === \"VERIFIED\") {\r\n        redirect(\"/doctor\");\r\n      } else {\r\n        redirect(\"/doctor/verification\");\r\n      }\r\n    } else if (user.role === \"ADMIN\") {\r\n      redirect(\"/admin\");\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"container mx-auto px-4 py-12\">\r\n      <div className=\"max-w-3xl mx-auto\">\r\n        <div className=\"text-center mb-10\">\r\n          <h1 className=\"text-3xl font-bold text-white mb-2\">\r\n            Welcome to MediMeet\r\n          </h1>\r\n          <p className=\"text-muted-foreground text-lg\">\r\n            Tell us how you want to use the platform\r\n          </p>\r\n        </div>\r\n\r\n        {children}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAAA;;;;AAEO,MAAM,WAAW;IACtB,OAAO;IACP,aAAa;AACf;AAEe,eAAe,iBAAiB,EAAE,QAAQ,EAAE;IACzD,4BAA4B;IAC5B,MAAM,OAAO,MAAM,CAAA,GAAA,qHAAA,CAAA,iBAAc,AAAD;IAEhC,uDAAuD;IACvD,IAAI,MAAM;QACR,IAAI,KAAK,IAAI,KAAK,WAAW;YAC3B,CAAA,GAAA,qLAAA,CAAA,WAAQ,AAAD,EAAE;QACX,OAAO,IAAI,KAAK,IAAI,KAAK,UAAU;YACjC,wCAAwC;YACxC,IAAI,KAAK,kBAAkB,KAAK,YAAY;gBAC1C,CAAA,GAAA,qLAAA,CAAA,WAAQ,AAAD,EAAE;YACX,OAAO;gBACL,CAAA,GAAA,qLAAA,CAAA,WAAQ,AAAD,EAAE;YACX;QACF,OAAO,IAAI,KAAK,IAAI,KAAK,SAAS;YAChC,CAAA,GAAA,qLAAA,CAAA,WAAQ,AAAD,EAAE;QACX;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAG,WAAU;sCAAqC;;;;;;sCAGnD,8OAAC;4BAAE,WAAU;sCAAgC;;;;;;;;;;;;gBAK9C;;;;;;;;;;;;AAIT","debugId":null}}]
}